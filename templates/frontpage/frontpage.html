<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ролевые клубы на карте России</title>
    <meta charset="UTF-8">


    {?*head.assets="development"*}
    <script type="text/javascript" src="/frontend/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/frontend/leaflet/leaflet.js"></script>
    <link rel="stylesheet" href="/frontend/leaflet/leaflet.css" />

    <!-- danwild/leaflet-fa-markers -->
    <script type="text/javascript" src="/frontend/leaflet/L.Icon.FontAwesome.js"></script>
    <link rel="stylesheet" href="/frontend/leaflet/L.Icon.FontAwesome.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" />

    <!-- marker clusters -->
    <link rel="stylesheet" href="/frontend/leaflet/MarkerCluster.css">
    <link rel="stylesheet" href="/frontend/leaflet/MarkerCluster.Default.css">
    <script type="text/javascript" src="/frontend/leaflet/leaflet.markercluster.js"></script>

    <script type="text/javascript" src="/frontend/leaflet/L.Control.Zoomslider.js"></script>
    <link rel="stylesheet" href="/frontend/leaflet/L.Control.Zoomslider.css" />

    <script type="text/javascript" src="/frontend/front.js"></script>
    <link rel="stylesheet" href="/frontend/front.css">
    {?}
    {?*head.assets="production"*}
    <script type="text/javascript" src="/public/scripts.js"></script>
    <link rel="stylesheet" href="/public/styles.css">
    {?}

    <script type="text/javascript" id="data">
        var userlocation = { ip_lat: '{*location.ip_lat*}', ip_lng: '{*location.ip_lng*}', city: '{*location.city*}', city_lat: '{*location.city_lat*}', city_lng: '{*location.city_lng*}' };
        var clubs_list = [ {%*clubs_list*} { id: {*clubs_list:id*}, lat: {*clubs_list:lat*}, lng: {*clubs_list:lng*} }, {%} ];
    </script>

</head>
<body>

<div tabindex="0" class="leaflet-container leaflet-fade-anim leaflet-grab leaflet-touch-drag" id="map"></div>


<script type="text/javascript" id="main">
    $(function(){
        var map = __CreateMap("map", userlocation, 12);

        createControl_AboutBox();
        createControl_InfoBox();

        map.addControl( new L.Control.AboutBox() );
        map.addControl( new L.Control.InfoBox() );

        var layer_ows = L.markerClusterGroup();
        layer_ows.addTo(map);

        $.each(clubs_list, function(index, data){
            let marker = L.marker([data.lat, data.lng], {
                icon: L.icon.fontAwesome({
                    iconClasses: 'fa fa-cubes', // cube, cubes, eyes, smile
                    markerColor: '#00a9ce',
                    iconColor: '#FFF',
                    iconXOffset: -4,
                    iconYOffset: -1,
                }),
                id: data.id
            }).on('click', function() {
                load_poi_content(this.options.id, "section-infobox-content");
            } );
            layer_ows.addLayer(marker);
        });

    }).on('click', '#actor-about-toggle', function() {
        let state = $(this).data('content-is-visible');
        $('#' + $(this).data('content')).toggle();
        $(this).data('content-is-visible', !state);
    }).escape(function(){
        $("#section-infobox-content").hide();
    });

    $(document.links).filter(function() {
        return this.hostname != window.location.hostname;
    }).attr('target', '_blank');

</script>

<section id="section-infobox" class="section-infobox-wrapper invisible" data-leaflet-control-position="{*section.infobox_position*}">
    /*
    <div style="text-align: left">
        <button id="actor-section-infobox-toggle" class="section-infobox-button-toggle-visibility" data-content="section-info-content" data-content-visibility="false">Скрыть</button>
    </div> */
    <div id="section-infobox-content" class="section-infobox-content invisible"></div>
</section>

<section id="section-about" class="section-about-wrapper invisible" data-leaflet-control-position="{*section.about_position*}">
    <div style="text-align: right">
        <button id="actor-about-toggle" class="action-toggle-div-visibility" data-content="section-about-content" data-content-is-visible="false">?</button>
    </div>

    <div id="section-about-content" class="invisible section-about-content">
        <h2>Ролевые клубы РФ на карте</h2>
        <div>
            Здравствуйте. Это совершенно некоммерческий проект<br/>
            и создатель не извлекает из него абсолютно никакой прибыли<br>
            (пока что одни только затраты).
        </div>
        <div>
            Если вы хотите добавить свой клуб на карту, напишите сюда: <a href="mailto:rpgclubsrf@yandex.ru">rpgclubsrf@yandex.ru</a>
        </div>
    </div>
</section>


</body>
</html>
<!-- copyright -->